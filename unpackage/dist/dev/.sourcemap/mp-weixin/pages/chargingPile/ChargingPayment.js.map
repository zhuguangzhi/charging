{"version":3,"sources":["uni-app:///main.js","webpack:///D:/Code/qianling/charging/charging/pages/chargingPile/ChargingPayment.vue?b355","webpack:///D:/Code/qianling/charging/charging/pages/chargingPile/ChargingPayment.vue?75cd","webpack:///D:/Code/qianling/charging/charging/pages/chargingPile/ChargingPayment.vue?6db4","webpack:///D:/Code/qianling/charging/charging/pages/chargingPile/ChargingPayment.vue?4f7b","uni-app:///pages/chargingPile/ChargingPayment.vue","webpack:///D:/Code/qianling/charging/charging/pages/chargingPile/ChargingPayment.vue?41ba","webpack:///D:/Code/qianling/charging/charging/pages/chargingPile/ChargingPayment.vue?71a1"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","couponShow","moneyList","currentMoneyIndex","payChannel","useMoneyInput","discount","discountList","pileCode","pileInfo","gunInfo","pickerIndex","gunList","showPicker","components","CouponItem","onLoad","methods","getChargerState","bindPickerChange","console","uni","title","icon","mask","getData","getPayment","page","row","tenantId","res","getPileInfo","code","index","item","payClick","changeChose","choseDiscount","cancelCoupon","confirmPayment","duration","OrderApi","appId","merchantId","type","channel","paySource","couponId","payable","time","gunCode","service","success","provider","orderInfo","timeStamp","nonceStr","package","signType","paySign","_debug","complete","content","cancelText","confirmText","formatName"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,wBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwI;AACxI;AACmE;AACL;AACsC;;;AAGpG;AAC6K;AAC7K,gBAAgB,iLAAU;AAC1B,EAAE,qFAAM;AACR,EAAE,sGAAM;AACR,EAAE,+GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,6SAEN;AACP,KAAK;AACL;AACA,aAAa,uSAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjEA;AAAA;AAAA;AAAA;AAA8pB,CAAgB,6oBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;AC0HlrB;AACA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACAC;EACA;EACAC;IACA;MACA;MACA;MACA;MACA;MACA;MACA;MAEA;MACA;MACA;MACA;IACA;MACA;MACA;MACA;IACA;IACA;IACA;IACA;EACA;;EACAC;IACAC;MACA;QACA;MACA,OACA;QACA;MACA,OACA;QACA;MACA;IACA;IACAC;MACA;MACAC;MACA;QACAC;UACAC;UACAC;UACAC;QACA;QACA;MACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACA;gBACA;gBAAA;cAAA;gBAGAJ;kBACAC;kBACAE;gBACA;gBAAA;gBAAA,OACA;cAAA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;kBAAAC;kBAAAC;kBAAAC;gBAAA;cAAA;gBAAAC;gBACA;kBACA;gBACA;gBACAT;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAU;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACA;kBAAAC;gBAAA;cAAA;gBAAAF;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBACAV;gBACA;gBACA;gBACA;gBACAa;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBACAC;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBACA;gBACA;gBAAA;cAAA;gBAJAD;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OASA;cAAA;gBAEAZ;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACAc;MACA;QACA;UACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,sBACA;kBAAA;kBAAA;gBAAA;gBACAlB;kBACAC;kBACAC;kBACAiB;gBACA;gBAAA,kCACA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBACAnB;kBACAC;kBACAC;kBACAiB;gBACA;gBAAA,kCACA;cAAA;gBAEAnB;kBACAC;gBACA;gBACA;gBACA;gBACA;gBAAA;gBAAA,OACA,mBACAmB;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAzC;kBACA0C;gBACA,GACA;cAAA;gBAbApB;gBAcAT;gBACA;kBACAA;oBACA8B;oBACAC;sBACA;sBACA/B;wBACAgC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBACAC;wBAAA;wBACAC;0BACAxC;4BACAyC;4BACAC;4BACAC;4BACAZ;8BACA;gCACA;gCACA;8BACA;gCACA;8BACA;4BACA;0BACA;wBACA;sBACA;oBACA;kBACA;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAa;MACA;MACA;;MAEA;MACA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC5VA;AAAA;AAAA;AAAA;AAAyuC,CAAgB,qoCAAG,EAAC,C;;;;;;;;;;;ACA7vC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/chargingPile/ChargingPayment.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/chargingPile/ChargingPayment.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./ChargingPayment.vue?vue&type=template&id=255291e2&scoped=true&\"\nvar renderjs\nimport script from \"./ChargingPayment.vue?vue&type=script&lang=js&\"\nexport * from \"./ChargingPayment.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChargingPayment.vue?vue&type=style&index=0&id=255291e2&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"255291e2\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chargingPile/ChargingPayment.vue\"\nexport default component.exports","export * from \"-!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ChargingPayment.vue?vue&type=template&id=255291e2&scoped=true&\"","var components\ntry {\n  components = {\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-button/u-button\" */ \"@/uni_modules/uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uview-ui/components/u-popup/u-popup\" */ \"@/uni_modules/uview-ui/components/u-popup/u-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.gunList, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n    var m0 = _vm.formatName(item.name)\n    var m1 = _vm.getChargerState(item)\n    return {\n      $orig: $orig,\n      m0: m0,\n      m1: m1,\n    }\n  })\n  var g0 = _vm.discountList.length\n  var g1 = _vm.discountList.length\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.couponShow = true\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n        g0: g0,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ChargingPayment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ChargingPayment.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"charging-payment\">\r\n\t\t<!-- 端口信息 -->\r\n\t\t<view class=\"charging-payment-header\">\r\n\t\t\t<text class=\"title\">充电桩：{{ pileInfo.name || \"\" }}</text>\r\n\t\t\t<text class=\"port\">充电枪： {{ gunInfo.name || \"\" }}</text>\r\n\t\t\t<text class=\"port\">地址：{{ pileInfo.address || \"\" }}</text>\r\n\t\t\t<view class=\"chargingBox\">\r\n\t\t\t\t<view @click=\"bindPickerChange(index)\"\r\n\t\t\t\t\t  :class=\"{\r\n\t\t\t\t\t\t  borderColor:pickerIndex === index,\r\n\t\t\t\t\t\t  disabledCharger:item.online!=1,\r\n\t\t\t\t\t\t  occupyCharger:item.status!=0\r\n\t\t\t\t\t\t}\"\r\n\t\t\t\t\t  class=\"chargingItem\"\r\n\t\t\t\t\t  v-for=\"(item, index) in gunList\" :key=\"index\">\r\n\t\t\t\t\t  <text>{{ formatName(item.name) }}</text>\r\n\t\t\t\t\t  <text class=\"chargingItem_state\">{{getChargerState(item)}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t<!-- \t\t<view style=\"display: flex;flex-direction: column;\" v-if=\"gunInfo.online == 2\">\r\n\t\t\t\t<image class=\"chargingImg\" src=\"/static/Img/chargingImg/charging.png\" mode=\"\"></image>\r\n\t\t\t\t<view class=\"chargingMsg\">设备未连接</view>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"display: flex;flex-direction: column;\" v-else-if=\"gunInfo.online == 1\">\r\n\t\t\t\t<image class=\"chargingImg\" src=\"/static/Img/chargingImg/online.png\" mode=\"\"></image>\r\n\t\t\t\t<view class=\"chargingMsg\">设备已连接</view>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"display: flex;flex-direction: column;\" v-else>\r\n\t\t\t\t<image class=\"chargingImg\" src=\"/static/Img/chargingImg/charging.png\" mode=\"\"></image>\r\n\t\t\t\t<view class=\"chargingMsg\">未选择设备</view>\r\n\t\t\t</view> -->\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 支付金额 -->\r\n\t\t<view class=\"charging-payment-money\">\r\n\t\t\t<text>充电金额</text>\r\n\t\t\t<text>（按时计费）</text>\r\n\t\t\t<view class=\"chose-money\">\r\n\t\t\t\t<text @click=\"changeChose(index)\" :class=\"currentMoneyIndex === index ? 'borderColor' : ''\" v-for=\"(item, index) in moneyList\" :key=\"index\">\r\n\t\t\t\t\t{{ item.cost / 100 }}元\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n<!-- \t\t<view @click=\"showPicker=true\" class=\"charging-payment-discount\">\r\n\t\t\t<text>充电枪</text>\r\n\t\t\t<picker mode=\"selector\" :show=\"showPicker\" @change=\"bindPickerChange\" :value=\"pickerIndex\" :range=\"gunList.map(item=>item.name)\">\r\n\t\t\t\t<text>{{gunList[pickerIndex].name}}</text>\r\n\t\t\t</picker>\r\n\t\t</view> -->\r\n\t\t<!-- 优惠券 -->\r\n\t\t<view @click=\"choseDiscount()\" class=\"charging-payment-discount\">\r\n\t\t\t<text>{{ discount.id == null ? '优惠券' : discount.desc }}</text>\r\n\t\t\t<text>{{ discountList.length }}张可用 ></text>\r\n\t\t</view>\r\n\t\t<view class=\"charging-payment-discount\">\r\n\t\t\t<text style=\"white-space: nowrap;\">收费规则</text>\r\n\t\t\t<text>{{ pileInfo.rule.memo }}</text>\r\n\t\t</view>\r\n\t\t<!-- 支付方式 -->\r\n\t\t<!-- <view class=\"charging-payment-type\">\r\n\t\t\t<view @click=\"changeChose('payType',0)\"  class=\"walletPay\">\r\n\t\t\t\t<image class=\"payIcon\" src=\"../../static/assert/dialogicon2.png\" mode=\"\" />\r\n\t\t\t\t<text>钱包支付</text>\r\n\t\t\t\t<icon :style=\"{display:paymentType===0?'block':''}\" class=\"selectIcon\" type=\"success_no_circle\" size=\"14\"/>\r\n\t\t\t</view>\r\n\t\t\t<view @click=\"changeChose('payType',1)\"  class=\"weChatPay\">\r\n\t\t\t\t<image class=\"payIcon\" src=\"../../static/assert/dialogicon2.png\" mode=\"\" />\r\n\t\t\t\t<text>微信支付</text>\r\n\t\t\t\t<icon :style=\"{display:paymentType===1?'block':''}\" class=\"selectIcon\" type=\"success_no_circle\" size=\"14\"/>\r\n\t\t\t</view>\r\n\t\t</view> -->\r\n\r\n\t\t<!-- 确认按钮 -->\r\n\t\t<view class=\"charging-payment-confirm\">\r\n\t\t\t<u-button\r\n\t\t\t\tclass=\"theme\"\r\n\t\t\t\t:custom-style=\"{\r\n\t\t\t\t\tmarginTop: '16rpx',\r\n\t\t\t\t\tmarginLeft: '32rpx',\r\n\t\t\t\t\tmarginRight: '32rpx',\r\n\t\t\t\t\twidth: 'calc(100% - 64rpx)'\r\n\t\t\t\t}\"\r\n\t\t\t\t@click=\"confirmPayment()\"\r\n\t\t\t>\r\n\t\t\t\t确认支付\r\n\t\t\t</u-button>\r\n\t\t</view>\r\n\t\t<u-popup class=\"charging-payment-discount-popup\" :closeable=\"false\" @close=\"cancelCoupon\" @open=\"couponShow = true\" :show=\"couponShow\" mode=\"bottom\" border-radius=\"14\">\r\n\t\t\t<view v-if=\"discountList.length===0\" style=\"height: 20vh;text-align: center;padding-top: 60px;\">暂无优惠券</view>\r\n\t\t\t<scroll-view v-else scroll-y=\"true\" style=\"height: 50vh; margin-top: 16rpx; overflow: hidden\">\r\n\t\t\t\t<view style=\"padding: 16rpx\">\r\n\t\t\t\t\t<CouponItem\r\n\t\t\t\t\t\tv-for=\"(item, index) in discountList\"\r\n\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\t:amount=\"item.money\"\r\n\t\t\t\t\t\t:name=\"item.name\"\r\n\t\t\t\t\t\t:availTo=\"item.couponExpired\"\r\n\t\t\t\t\t\t@click=\"selectCouponClick(item)\"\r\n\t\t\t\t\t></CouponItem>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t\t<u-button\r\n\t\t\t\tclass=\"theme\"\r\n\t\t\t\t:custom-style=\"{\r\n\t\t\t\t\tmarginTop: '16rpx',\r\n\t\t\t\t\tmarginLeft: '32rpx',\r\n\t\t\t\t\tmarginRight: '32rpx',\r\n\t\t\t\t\tcolor: '#fff',\r\n\t\t\t\t\twidth: 'calc(100% - 64rpx)'\r\n\t\t\t\t}\"\r\n\t\t\t\t@click.stop=\"cancelCoupon()\"\r\n\t\t\t>\r\n\t\t\t\t取消使用优惠券\r\n\t\t\t</u-button>\r\n\t\t</u-popup>\r\n\t\t\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport CouponItem from './components/coupon-item.vue';\r\nimport { OrderApi, ApiBase, errorCheck, device } from '@/common/apis.js';\r\nimport { getNowFormatDate, routePush, urlParamHash, delayed } from '@/common/baseFun.js';\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcouponShow: false,\r\n\t\t\tmoneyList: [],\r\n\t\t\tcurrentMoneyIndex: 0, //当前选中金额的index\r\n\t\t\tpayChannel: 'Wallet', //支付方式\r\n\t\t\tuseMoneyInput: false, //选择其他金额的弹出框\r\n\t\t\tdiscount: {}, //选择的优惠券\r\n\t\t\tdiscountList: [], //优惠券列表\r\n\t\t\t// gunCode: '',\r\n\t\t\tpileCode: '',\r\n\t\t\tpileInfo: null,\r\n\t\t\tgunInfo: null,\r\n\t\t\tpickerIndex:-1,\r\n\t\t\tgunList:[],//枪列表\r\n\t\t\tshowPicker:false\r\n\t\t};\r\n\t},\r\n\tcomponents: {\r\n\t\tCouponItem\r\n\t},\r\n\tonLoad(option_) {\r\n\t\tif (option_.q) {\r\n\t\t\t// 小程序二维码生成方案\r\n\t\t\tthis.type == 'out';\r\n\t\t\t// 获取到二维码原始链接内容\r\n\t\t\tconst q = decodeURIComponent(option_.q);\r\n\t\t\t// 用户扫码时间戳\r\n\t\t\tconst scancode_time = parseInt(option_.scancode_time);\r\n\r\n\t\t\tconst option = urlParamHash(q);\r\n\t\t\t// 获取到路由id\r\n\t\t\t// this.gunCode = option.gunCode;\r\n\t\t\tthis.pileCode = option.pileCode;\r\n\t\t} else {\r\n\t\t\t// 获取到路由id\r\n\t\t\t// this.gunCode = option_.gunCode;\r\n\t\t\tthis.pileCode = option_.pileCode;\r\n\t\t}\r\n\t\tthis.getData();\r\n\t\t// this.getPayment();\r\n\t\t// this.getPileInfo();\r\n\t},\r\n\tmethods: {\r\n\t\tgetChargerState(info) {\r\n\t\t\tif(info.online==2) {\r\n\t\t\t\treturn \"离线\"\r\n\t\t\t}\r\n\t\t\telse if(info.status!=0) {\r\n\t\t\t\treturn \"占用\"\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn \"可用\"\r\n\t\t\t}\r\n\t\t},\r\n \t\tbindPickerChange(index) {\r\n\t\t\tconst gun = this.gunList[index]\r\n\t\t\tconsole.log('gun',gun)\r\n\t\t\tif(gun.online!=1 || gun.status!=0) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '该设备暂不可用',\r\n\t\t\t\t\ticon:\"error\",\r\n\t\t\t\t\tmask: false\r\n\t\t\t\t});\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\tthis.pickerIndex = index\r\n\t\t\tthis.gunInfo = gun\r\n\t\t},\r\n\t\tasync getData() {\r\n\t\t\tif (this.$store.state.account.loginState == 2) {\r\n\t\t\t\t// this.getPayment();\r\n\t\t\t\tthis.getPileInfo();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '数据获取中',\r\n\t\t\t\tmask: false\r\n\t\t\t});\r\n\t\t\tawait delayed(1000);\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\t// 获取缴费金额\r\n\t\tasync getPayment() {\r\n\t\t\tconst res = await ApiBase(OrderApi.GetPayment({ page: 1, row: 9999, tenantId: this.pileInfo.tenantId }));\r\n\t\t\tif (errorCheck(res.result, res.error)) {\r\n\t\t\t\tthis.moneyList = res.result.data.data;\r\n\t\t\t}\r\n\t\t\tuni.hideLoading();\r\n\t\t},\r\n\t\t// 获取桩信息\r\n\t\tasync getPileInfo() {\r\n\t\t\tconst res = await ApiBase(device.GetDevice({ code: this.pileCode }));\r\n\t\t\tif (errorCheck(res.result, res.error)) {\r\n\t\t\t\tconsole.log('res.result', res.result);\r\n\t\t\t\tthis.pileInfo = res.result.data.data[0];\r\n\t\t\t\tthis.gunList = this.pileInfo.deviceList\r\n\t\t\t\t//  找到可用的枪\r\n\t\t\t\tfor(let index=0;index<this.gunList.length;index++) {\r\n\t\t\t\t\tlet item = this.gunList[index]\r\n\t\t\t\t\tif(item.online==1 && item.status==0) {\r\n\t\t\t\t\t\tthis.gunInfo = item\r\n\t\t\t\t\t\tthis.pickerIndex = index\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// this.gunInfo = res.result.data.data[0]?.deviceList.find(item => item.code === this.gunCode);\r\n\t\t\t\tawait this.getPayment()\r\n\t\t\t}\r\n\t\t\tuni.hideLoading();\r\n\t\t},\r\n\t\tpayClick(channel) {\r\n\t\t\tif (this.pay <= 0) {\r\n\t\t\t\tif (channel == 'Wallet') {\r\n\t\t\t\t\tthis.payChannel = channel;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.payChannel = channel;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 改变选择的金额或支付方式\r\n\t\tchangeChose(index) {\r\n\t\t\tthis.currentMoneyIndex = index;\r\n\t\t\t// switch(type){\r\n\t\t\t// \tcase 'payType':\r\n\t\t\t// \t\tthis.paymentType = index;\r\n\t\t\t// \t\tbreak;\r\n\t\t\t// \tcase 'money':\r\n\t\t\t// \t\tthis.currentMoneyIndex = index;\r\n\t\t\t// \t\tbreak;\r\n\t\t\t// }\r\n\t\t},\r\n\t\t// 选择优惠券\r\n\t\tchoseDiscount() {\r\n\t\t\tthis.couponShow = true;\r\n\t\t},\r\n\t\tcancelCoupon() {\r\n\t\t\tthis.couponShow = false;\r\n\t\t},\r\n\t\t// 确定支付\r\n\t\tasync confirmPayment() {\r\n\t\t\tif(!this.gunInfo?.code) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '请选择充电枪',\r\n\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (this.gunInfo.online == 2) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '该设备暂不可用',\r\n\t\t\t\t\ticon: 'error',\r\n\t\t\t\t\tduration: 1500\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '支付中...'\r\n\t\t\t});\r\n\t\t\t// let url = `/pages/chargingPile/ChargingOrder?orderId=1514229891838337025`\r\n\t\t\t// routePush(url)\r\n\t\t\t// return false;\r\n\t\t\tconst res = await ApiBase(\r\n\t\t\t\tOrderApi.StartPayment({\r\n\t\t\t\t\tappId: this.pileInfo.wxPayMerchant.appId,\r\n\t\t\t\t\tmerchantId: this.pileInfo.wxPayMerchant.id,\r\n\t\t\t\t\ttype: 7,\r\n\t\t\t\t\tchannel: 'WeChat',\r\n\t\t\t\t\tpaySource: 'WXH5',\r\n\t\t\t\t\tcouponId: '',\r\n\t\t\t\t\tpayable: this.moneyList[this.currentMoneyIndex].cost,\r\n\t\t\t\t\ttime: getNowFormatDate(),\r\n\t\t\t\t\tpileCode: this.pileCode,\r\n\t\t\t\t\tgunCode: this.gunInfo.code\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t\tuni.hideLoading();\r\n\t\t\tif (errorCheck(res.result, res.error)) {\r\n\t\t\t\tuni.getProvider({\r\n\t\t\t\t\tservice: 'payment',\r\n\t\t\t\t\tsuccess(e) {\r\n\t\t\t\t\t\tlet data = res.result.data.data;\r\n\t\t\t\t\t\tuni.requestPayment({\r\n\t\t\t\t\t\t\tprovider: e.provider[0],\r\n\t\t\t\t\t\t\torderInfo: data.bill,\r\n\t\t\t\t\t\t\ttimeStamp: data.data.timeStamp,\r\n\t\t\t\t\t\t\tnonceStr: data.data.nonceStr,\r\n\t\t\t\t\t\t\tpackage: data.data.packageValue,\r\n\t\t\t\t\t\t\tsignType: data.data.signType,\r\n\t\t\t\t\t\t\tpaySign: data.data.paySign,\r\n\t\t\t\t\t\t\t_debug: 1, //调试专用\r\n\t\t\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\tcontent: '支付已完成',\r\n\t\t\t\t\t\t\t\t\tcancelText: '否',\r\n\t\t\t\t\t\t\t\t\tconfirmText: '是',\r\n\t\t\t\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\t// 确定\r\n\t\t\t\t\t\t\t\t\t\t\troutePush(`/pages/chargingPile/Order`,'reLaunch');\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\troutePush('/pages/index/index','reLaunch');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// uni.navigateTo({url:'/pages/chargingPile/ChargingOrder'})\r\n\t\t},\r\n\t\t//  格式化名称\r\n\t\tformatName(name) {\r\n\t\t\t// 使用 lastIndexOf 查找最后一个下划线的位置\r\n\t\t\tconst lastUnderscoreIndex = name.lastIndexOf(\"_\");\r\n\t\t\t\r\n\t\t\t// 如果找到了下划线，就截取它之后的部分，否则返回原始字符串\r\n\t\t\treturn lastUnderscoreIndex !== -1 ? name.slice(lastUnderscoreIndex + 1) : name;\r\n\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.charging-payment {\r\n\twidth: 100vw;\r\n\tbackground-color: #f5f5f5;\r\n\t&-confirm {\r\n\t\twidth: 100%;\r\n\t\theight: 50px;\r\n\t\tpadding: 16px;\r\n\t\tbox-sizing: border-box;\r\n\t\tfont-size: 14px;\r\n\t\tbackground-color: #ffffff;\r\n\t}\r\n\t&-header {\r\n\t\tpadding: 18px 8px;\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #979797;\r\n\t\tbackground-color: #ffffff;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\ttext {\r\n\t\t\tdisplay: block;\r\n\t\t\tmargin-bottom: 8px;\r\n\t\t}\r\n\t\t.title {\r\n\t\t\tfont-size: 14px;\r\n\t\t}\r\n\t\t.chargingImg {\r\n\t\t\tmargin: 0 auto;\r\n\t\t\twidth: 150rpx;\r\n\t\t\theight: 150rpx;\r\n\t\t}\r\n\t\t.chargingMsg {\r\n\t\t\tdisplay: block;\r\n\t\t\ttext-align: center;\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t\tfont-size: 14px;\r\n\t\t}\r\n\t}\r\n\t&-money,\r\n\t&-discount,\r\n\t&-type {\r\n\t\tmargin: 8px 0;\r\n\t\twidth: 100%;\r\n\t\tpadding: 16px 8px;\r\n\t\tbox-sizing: border-box;\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #979797;\r\n\t\tbackground-color: #ffffff;\r\n\t\ttext:first-child {\r\n\t\t\tcolor: #000000;\r\n\t\t}\r\n\t\t.chose-money {\r\n\t\t\twidth: 100%;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tflex-wrap: wrap;\r\n\t\t\t// justify-content: space-between;\r\n\t\t\ttext{\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t\twidth: 30%;\r\n\t\t\t\tborder: 2px solid #979797;\r\n\t\t\t\tborder-radius: 5px;\r\n\t\t\t\tmargin-top: 8px;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tline-height: 80rpx;\r\n\t\t\t\tfont-size: 14px;\r\n\t\t\t\tcolor: #979797;\r\n\t\t\t\tmargin: 1.65% 1.65%;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t&-discount {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\ttext:last-child {\r\n\t\t\tpadding: 0 16px;\r\n\t\t}\r\n\t}\r\n\t&-type {\r\n\t\tpadding: 0 8px;\r\n\t\tfont-size: 14px;\r\n\t\t.walletPay,\r\n\t\t.weChatPay {\r\n\t\t\tposition: relative;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 40px;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tline-height: 40px;\r\n\t\t\t.payIcon {\r\n\t\t\t\twidth: 30rpx;\r\n\t\t\t\theight: 30rpx;\r\n\t\t\t\tvertical-align: middle;\r\n\t\t\t\tmargin-right: 8px;\r\n\t\t\t}\r\n\t\t\t.selectIcon {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tright: 8px;\r\n\t\t\t\tfont-size: 14px;\r\n\t\t\t\tdisplay: none;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.walletPay {\r\n\t\t\tborder-bottom: 1px solid #cccccc;\r\n\t\t}\r\n\t}\r\n\r\n\t// .chose-money-select {\r\n\t// \tborder-color: var(--color)!important;\r\n\t// \tcolor: var(--color)!important;\r\n\t// }\r\n\t.paymentBtn {\r\n\t\tmargin: 16px;\r\n\t\tborder: none;\r\n\t\t// background-color: var(--color);\r\n\t\t// color: var(--fontColor);\r\n\t\tfont-size: 14px;\r\n\t\tpadding: 8px 0;\r\n\t}\r\n\t.chargingBox {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3,1fr);\r\n\t\tgrid-column-gap: 10px;\r\n\t\tgrid-row-gap: 10px;\r\n\t\t.chargingItem {\r\n\t\t\tposition: relative;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\theight: 80rpx;\r\n\t\t\tborder: 2px solid #979797;\r\n\t\t\tborder-radius: 5px;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tfont-size: 16px;\r\n\t\t\tcolor: #979797;\r\n\t\t\t&_state {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tbottom: -10rpx;\r\n\t\t\t\tright: 16rpx;\r\n\t\t\t\tfont-size: 12px;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.disabledCharger {\r\n\t\tborder-color: #C4C6C9 !important;\r\n\t\tbackground-color: #C4C6C9;\r\n\t\ttext {\r\n\t\t\tcolor: white!important;\r\n\t\t}\r\n\t}\r\n\t.occupyCharger {\r\n\t\tborder-color: #F9AE3D !important;\r\n\t\ttext {\r\n\t\t\tcolor: #F9AE3D!important;\r\n\t\t}\r\n\t}\r\n}\r\n</style>\n","import mod from \"-!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ChargingPayment.vue?vue&type=style&index=0&id=255291e2&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../IDE/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ChargingPayment.vue?vue&type=style&index=0&id=255291e2&scoped=true&lang=less&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1709864493883\n      var cssReload = require(\"D:/IDE/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}